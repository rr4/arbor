!function($,window,document,undefined){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t});var trace=function(msg){if(void 0!==window&&window.console){for(var len=arguments.length,args=[],i=0;i<len;i++)args.push("arguments["+i+"]");eval("console.log("+args.join(",")+")")}},dirname=function(e){var n=e.replace(/^\/?(.*?)\/?$/,"$1").split("/");return n.pop(),"/"+n.join("/")},basename=function(e){var n=e.replace(/^\/?(.*?)\/?$/,"$1").split("/").pop();return""==n?null:n},_ordinalize_re=/(\d)(?=(\d\d\d)+(?!\d))/g,ordinalize=function(e){var n=""+e;return e<11e3?n=(""+e).replace(_ordinalize_re,"$1,"):e<1e6?n=Math.floor(e/1e3)+"k":e<1e9&&(n=(""+Math.floor(e/1e3)).replace(_ordinalize_re,"$1,")+"m"),n},nano=function(e,n){return e.replace(/\{([\w\-\.]*)}/g,function(e,t){var i=t.split("."),r=n[i.shift()];return $.each(i,function(){r=r.hasOwnProperty(this)?r[this]:e}),r})},objcopy=function(e){if(e===undefined)return undefined;if(null===e)return null;if(e.parentNode)return e;switch(typeof e){case"string":return e.substring(0);case"number":return e+0;case"boolean":return!0===e}var n=$.isArray(e)?[]:{};return $.each(e,function(e,t){n[e]=objcopy(t)}),n},objmerge=function(e,n){e=e||{},n=n||{};var t=objcopy(e);for(var i in n)t[i]=n[i];return t},objcmp=function(e,n,t){if(!e||!n)return e===n;if(typeof e!=typeof n)return!1;if("object"!=typeof e)return e===n;if($.isArray(e)){if(!$.isArray(n))return!1;if(e.length!=n.length)return!1}else{var i=[];for(var r in e)e.hasOwnProperty(r)&&i.push(r);var o=[];for(var r in n)n.hasOwnProperty(r)&&o.push(r);if(t||(i.sort(),o.sort()),i.join(",")!==o.join(","))return!1}var a=!0;return $.each(e,function(t){var i=objcmp(e[t],n[t]);if(!(a=a&&i))return!1}),a},objkeys=function(e){var n=[];return $.each(e,function(t,i){e.hasOwnProperty(t)&&n.push(t)}),n},objcontains=function(e){if(!e||"object"!=typeof e)return!1;for(var n=1,t=arguments.length;n<t;n++)if(e.hasOwnProperty(arguments[n]))return!0;return!1},uniq=function(e){for(var n=e.length,t={},i=0;i<n;i++)t[e[i]]=!0;return objkeys(t)},arbor_path=function(){var e=$("script").map(function(e){var n=$(this).attr("src");if(n)return n.match(/arbor[^\/\.]*.js|dev.js/)?n.match(/.*\//)||"/":void 0});return e.length>0?e[0]:null},Kernel=function(e){var n="file:"==window.location.protocol&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1,t=window.Worker!==undefined&&!n,i=null,r=null,o=[];o.last=new Date;var a=null,d=null,s=null,u=null,c=!1,l={system:e,tween:null,nodes:{},init:function(){r="undefined"!=typeof Tween?Tween():void 0!==arbor.Tween?arbor.Tween():{busy:function(){return!1},tick:function(){return!0},to:function(){trace("Please include arbor-tween.js to enable tweens"),r.to=function(){}}},l.tween=r;var n=e.parameters();return t?(trace("arbor.js/web-workers",n),a=setInterval(l.screenUpdate,n.timeout),(i=new Worker(arbor_path()+"physics/worker.js")).onmessage=l.workerMsg,i.onerror=function(e){trace("physics:",e)},i.postMessage({type:"physics",physics:objmerge(n,{timeout:Math.ceil(n.timeout)})})):(trace("arbor.js/single-threaded",n),i=Physics(n.dt,n.stiffness,n.repulsion,n.friction,l.system._updateGeometry,n.integrator),l.start()),l},graphChanged:function(e){t?i.postMessage({type:"changes",changes:e}):i._update(e),l.start()},particleModified:function(e,n){t?i.postMessage({type:"modify",id:e,mods:n}):i.modifyNode(e,n),l.start()},physicsModified:function(e){isNaN(e.timeout)||(t?(clearInterval(a),a=setInterval(l.screenUpdate,e.timeout)):(clearInterval(s),s=null)),t?i.postMessage({type:"sys",param:e}):i.modifyPhysics(e),l.start()},workerMsg:function(e){"geometry"==e.data.type?l.workerUpdate(e.data):trace("physics:",e.data)},_lastPositions:null,workerUpdate:function(e){l._lastPositions=e,l._lastBounds=e.bounds},_lastFrametime:(new Date).valueOf(),_lastBounds:null,_currentRenderer:null,screenUpdate:function(){(new Date).valueOf();var e=!1;if(null!==l._lastPositions&&(l.system._updateGeometry(l._lastPositions),l._lastPositions=null,e=!0),r&&r.busy()&&(e=!0),l.system._updateBounds(l._lastBounds)&&(e=!0),e){var n=l.system.renderer;if(n!==undefined){n!==d&&(n.init(l.system),d=n),r&&r.tick(),n.redraw();var t=o.last;o.last=new Date,o.push(o.last-t),o.length>50&&o.shift()}}},physicsUpdate:function(){r&&r.tick(),i.tick();l.system._updateBounds();r&&r.busy();var e=l.system.renderer,n=new Date;(e=l.system.renderer)!==undefined&&(e!==d&&(e.init(l.system),d=e),e.redraw({timestamp:n}));var t=o.last;o.last=n,o.push(o.last-t),o.length>50&&o.shift();var a=i.systemEnergy();(a.mean+a.max)/2<.05?(null===u&&(u=(new Date).valueOf()),(new Date).valueOf()-u>1e3&&(clearInterval(s),s=null)):u=null},fps:function(e){if(e!==undefined){var n=1e3/Math.max(1,targetFps);l.physicsModified({timeout:n})}for(var t=0,i=0,r=o.length;i<r;i++)t+=o[i];var a=t/Math.max(1,o.length);return isNaN(a)?0:Math.round(1e3/a)},start:function(e){null===s&&(c&&!e||(c=!1,t?i.postMessage({type:"start"}):(u=null,s=setInterval(l.physicsUpdate,l.system.parameters().timeout))))},stop:function(){c=!0,t?i.postMessage({type:"stop"}):null!==s&&(clearInterval(s),s=null)}};return l.init()},Node=function(e){this._id=_nextNodeId++,this.data=e||{},this._mass=e.mass!==undefined?e.mass:1,this._fixed=!0===e.fixed,this._p=new Point("number"==typeof e.x?e.x:null,"number"==typeof e.y?e.y:null),delete this.data.x,delete this.data.y,delete this.data.mass,delete this.data.fixed},_nextNodeId=1,Edge=function(e,n,t){this._id=_nextEdgeId--,this.source=e,this.target=n,this.length=t.length!==undefined?t.length:1,this.data=t!==undefined?t:{},delete this.data.length},_nextEdgeId=-1,Particle=function(e,n){this.p=e,this.m=n,this.v=new Point(0,0),this.f=new Point(0,0)};Particle.prototype.applyForce=function(e){this.f=this.f.add(e.divide(this.m))};var Spring=function(e,n,t,i){this.point1=e,this.point2=n,this.length=t,this.k=i};Spring.prototype.distanceToParticle=function(e){var n=that.point2.p.subtract(that.point1.p).normalize().normal(),t=e.p.subtract(that.point1.p);return Math.abs(t.x*n.x+t.y*n.y)};var Point=function(e,n){e&&e.hasOwnProperty("y")&&(n=e.y,e=e.x),this.x=e,this.y=n};Point.random=function(e){return e=e!==undefined?e:5,new Point(2*e*(Math.random()-.5),2*e*(Math.random()-.5))},Point.prototype={exploded:function(){return isNaN(this.x)||isNaN(this.y)},add:function(e){return new Point(this.x+e.x,this.y+e.y)},subtract:function(e){return new Point(this.x-e.x,this.y-e.y)},multiply:function(e){return new Point(this.x*e,this.y*e)},divide:function(e){return new Point(this.x/e,this.y/e)},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normal:function(){return new Point(-this.y,this.x)},normalize:function(){return this.divide(this.magnitude())}};var ParticleSystem=function(e,n,t,i,r,o,a,d){var s=[],u=null,c=0,l=null,p=.04,f=[20,20,20,20],y=null,h=null;if("object"==typeof e){var m=e;t=m.friction,e=m.repulsion,r=m.fps,o=m.dt,n=m.stiffness,i=m.gravity,a=m.precision,d=m.integrator}"verlet"!=d&&"euler"!=d&&(d="verlet"),t=isNaN(t)?.5:t,e=isNaN(e)?1e3:e,r=isNaN(r)?55:r;var g,v={integrator:d,repulsion:e,stiffness:n=isNaN(n)?600:n,friction:t,dt:o=isNaN(o)?.02:o,gravity:i=!0===i,precision:a=isNaN(a)?.6:a,timeout:r!==undefined?1e3/r:20},_={renderer:null,tween:null,nodes:{},edges:{},adjacency:{},names:{},kernel:null},w={parameters:function(e){return e!==undefined&&(isNaN(e.precision)||(e.precision=Math.max(0,Math.min(1,e.precision))),$.each(v,function(n,t){e[n]!==undefined&&(v[n]=e[n])}),_.kernel.physicsModified(e)),v},fps:function(e){if(e===undefined)return _.kernel.fps();w.parameters({timeout:1e3/(e||50)})},start:function(){_.kernel.start()},stop:function(){_.kernel.stop()},addNode:function(e,n){n=n||{};var t=_.names[e];if(t)return t.data=n,t;if(e!=undefined){var i=n.x!=undefined?n.x:null,r=n.y!=undefined?n.y:null,o=n.fixed?1:0,a=new Node(n);return a.name=e,_.names[e]=a,_.nodes[a._id]=a,s.push({t:"addNode",id:a._id,m:a.mass,x:i,y:r,f:o}),w._notify(),a}},pruneNode:function(e){var n=w.getNode(e);void 0!==_.nodes[n._id]&&(delete _.nodes[n._id],delete _.names[n.name]),$.each(_.edges,function(e,t){t.source._id!==n._id&&t.target._id!==n._id||w.pruneEdge(t)}),s.push({t:"dropNode",id:n._id}),w._notify()},getNode:function(e){return e._id!==undefined?e:"string"==typeof e||"number"==typeof e?_.names[e]:void 0},eachNode:function(e){$.each(_.nodes,function(n,t){if(null!=t._p.x&&null!=t._p.y){var i=null!==l?w.toScreen(t._p):t._p;e.call(w,t,i)}})},addEdge:function(e,n,t){e=w.getNode(e)||w.addNode(e),n=w.getNode(n)||w.addNode(n);var i=new Edge(e,n,t=t||{}),r=e._id,o=n._id;if(_.adjacency[r]=_.adjacency[r]||{},_.adjacency[r][o]=_.adjacency[r][o]||[],!(_.adjacency[r][o].length>0)){_.edges[i._id]=i,_.adjacency[r][o].push(i);var a=i.length!==undefined?i.length:1;return s.push({t:"addSpring",id:i._id,fm:r,to:o,l:a}),w._notify(),i}$.extend(_.adjacency[r][o].data,i.data)},pruneEdge:function(e){s.push({t:"dropSpring",id:e._id}),delete _.edges[e._id];for(var n in _.adjacency)for(var t in _.adjacency[n])for(var i=_.adjacency[n][t].length-1;i>=0;i--)_.adjacency[n][t][i]._id===e._id&&_.adjacency[n][t].splice(i,1);w._notify()},getEdges:function(e,n){return e=w.getNode(e),n=w.getNode(n),e&&n&&void 0!==_.adjacency[e._id]&&void 0!==_.adjacency[e._id][n._id]?_.adjacency[e._id][n._id]:[]},getEdgesFrom:function(e){if(!(e=w.getNode(e)))return[];if(void 0!==_.adjacency[e._id]){var n=[];return $.each(_.adjacency[e._id],function(e,t){n=n.concat(t)}),n}return[]},getEdgesTo:function(e){if(!(e=w.getNode(e)))return[];var n=[];return $.each(_.edges,function(t,i){i.target==e&&n.push(i)}),n},eachEdge:function(e){$.each(_.edges,function(n,t){var i=_.nodes[t.source._id]._p,r=_.nodes[t.target._id]._p;null!=i.x&&null!=r.x&&(i=null!==l?w.toScreen(i):i,r=null!==l?w.toScreen(r):r,i&&r&&e.call(w,t,i,r))})},prune:function(e){var n={dropped:{nodes:[],edges:[]}};return e===undefined?$.each(_.nodes,function(e,t){n.dropped.nodes.push(t),w.pruneNode(t)}):w.eachNode(function(t){e.call(w,t,{from:w.getEdgesFrom(t),to:w.getEdgesTo(t)})&&(n.dropped.nodes.push(t),w.pruneNode(t))}),n},graft:function(e){var n={added:{nodes:[],edges:[]}};return e.nodes&&$.each(e.nodes,function(e,t){var i=w.getNode(e);i?i.data=t:n.added.nodes.push(w.addNode(e,t)),_.kernel.start()}),e.edges&&$.each(e.edges,function(e,t){w.getNode(e)||n.added.nodes.push(w.addNode(e,{})),$.each(t,function(t,i){w.getNode(t)||n.added.nodes.push(w.addNode(t,{}));var r=w.getEdges(e,t);r.length>0?r[0].data=i:n.added.edges.push(w.addEdge(e,t,i))})}),n},merge:function(e){var n={added:{nodes:[],edges:[]},dropped:{nodes:[],edges:[]}};$.each(_.edges,function(t,i){e.edges[i.source.name]!==undefined&&e.edges[i.source.name][i.target.name]!==undefined||(w.pruneEdge(i),n.dropped.edges.push(i))});var t=w.prune(function(t,i){if(e.nodes[t.name]===undefined)return n.dropped.nodes.push(t),!0}),i=w.graft(e);return n.added.nodes=n.added.nodes.concat(i.added.nodes),n.added.edges=n.added.edges.concat(i.added.edges),n.dropped.nodes=n.dropped.nodes.concat(t.dropped.nodes),n.dropped.edges=n.dropped.edges.concat(t.dropped.edges),n},tweenNode:function(e,n,t){var i=w.getNode(e);i&&_.tween.to(i,n,t)},tweenEdge:function(e,n,t,i){if(i===undefined)w._tweenEdge(e,n,t);else{var r=w.getEdges(e,n);$.each(r,function(e,n){w._tweenEdge(n,t,i)})}},_tweenEdge:function(e,n,t){e&&e._id!==undefined&&_.tween.to(e,n,t)},_updateGeometry:function(e){if(e!=undefined){var n=e.epoch<c;g=e.energy;var t=e.geometry;if(t!==undefined)for(var i=0,r=t.length/3;i<r;i++){var o=t[3*i];n&&_.nodes[o]==undefined||(_.nodes[o]._p.x=t[3*i+1],_.nodes[o]._p.y=t[3*i+2])}}},screen:function(e){if(e==undefined)return{size:l?objcopy(l):undefined,padding:f.concat(),step:p};e.size!==undefined&&w.screenSize(e.size.width,e.size.height),isNaN(e.step)||w.screenStep(e.step),e.padding!==undefined&&w.screenPadding(e.padding)},screenSize:function(e,n){l={width:e,height:n},w._updateBounds()},screenPadding:function(e,n,t,i){var r=(trbl=$.isArray(e)?e:[e,n,t,i])[0],o=trbl[1],a=trbl[2];o===undefined?trbl=[r,r,r,r]:a==undefined&&(trbl=[r,o,r,o]),f=trbl},screenStep:function(e){p=e},toScreen:function(e){if(y&&l){var n=f||[0,0,0,0],t=y.bottomright.subtract(y.topleft),i=n[3]+e.subtract(y.topleft).divide(t.x).x*(l.width-(n[1]+n[3])),r=n[0]+e.subtract(y.topleft).divide(t.y).y*(l.height-(n[0]+n[2]));return arbor.Point(i,r)}},fromScreen:function(e){if(y&&l){var n=f||[0,0,0,0],t=y.bottomright.subtract(y.topleft),i=(e.x-n[3])/(l.width-(n[1]+n[3]))*t.x+y.topleft.x,r=(e.y-n[0])/(l.height-(n[0]+n[2]))*t.y+y.topleft.y;return arbor.Point(i,r)}},_updateBounds:function(e){if(null!==l){h=e||w.bounds();var n=new Point(h.bottomright.x,h.bottomright.y),t=new Point(h.topleft.x,h.topleft.y),i=n.subtract(t),r=t.add(i.divide(2)),o=new Point(Math.max(i.x,4),Math.max(i.y,4));if(h.topleft=r.subtract(o.divide(2)),h.bottomright=r.add(o.divide(2)),!y)return!$.isEmptyObject(_.nodes)&&(y=h,!0);var a=p;_newBounds={bottomright:y.bottomright.add(h.bottomright.subtract(y.bottomright).multiply(a)),topleft:y.topleft.add(h.topleft.subtract(y.topleft).multiply(a))};var d=new Point(y.topleft.subtract(_newBounds.topleft).magnitude(),y.bottomright.subtract(_newBounds.bottomright).magnitude());return(d.x*l.width>1||d.y*l.height>1)&&(y=_newBounds,!0)}},energy:function(){return g},bounds:function(){var e=null,n=null;return $.each(_.nodes,function(t,i){if(!e)return e=new Point(i._p),void(n=new Point(i._p));var r=i._p;null!==r.x&&null!==r.y&&(r.x>e.x&&(e.x=r.x),r.y>e.y&&(e.y=r.y),r.x<n.x&&(n.x=r.x),r.y<n.y&&(n.y=r.y))}),e&&n?{bottomright:e,topleft:n}:{topleft:new Point(-1,-1),bottomright:new Point(1,1)}},nearest:function(e){null!==l&&(e=w.fromScreen(e));var n={node:null,point:null,distance:null};return $.each(_.nodes,function(t,i){var r=i._p;if(null!==r.x&&null!==r.y){var o=r.subtract(e).magnitude();(null===n.distance||o<n.distance)&&(n={node:i,point:r,distance:o},null!==l&&(n.screenPoint=w.toScreen(r)))}}),n.node?(null!==l&&(n.distance=w.toScreen(n.node.p).subtract(w.toScreen(e)).magnitude()),n):null},_notify:function(){null===u?c++:clearTimeout(u),u=setTimeout(w._synchronize,20)},_synchronize:function(){s.length>0&&(_.kernel.graphChanged(s),s=[],u=null)}};return _.kernel=Kernel(w),_.tween=_.kernel.tween||null,Node.prototype.__defineGetter__("p",function(){var e=this,n={};return n.__defineGetter__("x",function(){return e._p.x}),n.__defineSetter__("x",function(n){_.kernel.particleModified(e._id,{x:n})}),n.__defineGetter__("y",function(){return e._p.y}),n.__defineSetter__("y",function(n){_.kernel.particleModified(e._id,{y:n})}),n.__proto__=Point.prototype,n}),Node.prototype.__defineSetter__("p",function(e){this._p.x=e.x,this._p.y=e.y,_.kernel.particleModified(this._id,{x:e.x,y:e.y})}),Node.prototype.__defineGetter__("mass",function(){return this._mass}),Node.prototype.__defineSetter__("mass",function(e){this._mass=e,_.kernel.particleModified(this._id,{m:e})}),Node.prototype.__defineSetter__("tempMass",function(e){_.kernel.particleModified(this._id,{_m:e})}),Node.prototype.__defineGetter__("fixed",function(){return this._fixed}),Node.prototype.__defineSetter__("fixed",function(e){this._fixed=e,_.kernel.particleModified(this._id,{f:e?1:0})}),w},BarnesHutTree=function(){var e=[],n=0,t=null,i=.5,r={init:function(e,o,a){i=a,n=0,(t=r._newBranch()).origin=e,t.size=o.subtract(e)},insert:function(e){for(var n=t,i=[e];i.length;){var o=i.shift(),a=o._m||o.m,d=r._whichQuad(o,n);if(n[d]===undefined)n[d]=o,n.mass+=a,n.p?n.p=n.p.add(o.p.multiply(a)):n.p=o.p.multiply(a);else if("origin"in n[d])n.mass+=a,n.p?n.p=n.p.add(o.p.multiply(a)):n.p=o.p.multiply(a),n=n[d],i.unshift(o);else{var s=n.size.divide(2),u=new Point(n.origin);"s"==d[0]&&(u.y+=s.y),"e"==d[1]&&(u.x+=s.x);var c=n[d];if(n[d]=r._newBranch(),n[d].origin=u,n[d].size=s,n.mass=a,n.p=o.p.multiply(a),n=n[d],c.p.x===o.p.x&&c.p.y===o.p.y){var l=.08*s.x,p=.08*s.y;c.p.x=Math.min(u.x+s.x,Math.max(u.x,c.p.x-l/2+Math.random()*l)),c.p.y=Math.min(u.y+s.y,Math.max(u.y,c.p.y-p/2+Math.random()*p))}i.push(c),i.unshift(o)}}},applyForces:function(e,n){for(var r=[t];r.length;)if(node=r.shift(),node!==undefined&&e!==node)if("f"in node){var o=e.p.subtract(node.p),a=Math.max(1,o.magnitude()),d=(o.magnitude()>0?o:Point.random(1)).normalize();e.applyForce(d.multiply(n*(node._m||node.m)).divide(a*a))}else{var s=e.p.subtract(node.p.divide(node.mass)).magnitude();if(Math.sqrt(node.size.x*node.size.y)/s>i)r.push(node.ne),r.push(node.nw),r.push(node.se),r.push(node.sw);else{var o=e.p.subtract(node.p.divide(node.mass)),a=Math.max(1,o.magnitude()),d=(o.magnitude()>0?o:Point.random(1)).normalize();e.applyForce(d.multiply(n*node.mass).divide(a*a))}}},_whichQuad:function(e,n){if(e.p.exploded())return null;var t=e.p.subtract(n.origin),i=n.size.divide(2);return t.y<i.y?t.x<i.x?"nw":"ne":t.x<i.x?"sw":"se"},_newBranch:function(){if(e[n]){var t=e[n];t.ne=t.nw=t.se=t.sw=undefined,t.mass=0,delete t.p}else t={origin:null,size:null,nw:undefined,ne:undefined,sw:undefined,se:undefined,mass:0},e[n]=t;return n++,t}};return r},Physics=function(e,n,t,i,r,o){var a=BarnesHutTree(),d={particles:{},springs:{}},s={particles:{}},u=[],c=[],l=0,p={sum:0,max:0,mean:0},f={topleft:new Point(-1,-1),bottomright:new Point(1,1)},y={integrator:["verlet","euler"].indexOf(o)>=0?o:"verlet",stiffness:n!==undefined?n:1e3,repulsion:t!==undefined?t:600,friction:i!==undefined?i:.3,gravity:!1,dt:e!==undefined?e:.02,theta:.4,init:function(){return y},modifyPhysics:function(e){$.each(["stiffness","repulsion","friction","gravity","dt","precision","integrator"],function(n,t){if(e[t]!==undefined){if("precision"==t)return void(y.theta=1-e[t]);if(y[t]=e[t],"stiffness"==t){var i=e[t];$.each(d.springs,function(e,n){n.k=i})}}})},addNode:function(e){var n=e.id,t=e.m,i=f.bottomright.x-f.topleft.x,r=f.bottomright.y-f.topleft.y,o=new Point(null!=e.x?e.x:f.topleft.x+i*Math.random(),null!=e.y?e.y:f.topleft.y+r*Math.random());d.particles[n]=new Particle(o,t),d.particles[n].connections=0,d.particles[n].fixed=1===e.f,s.particles[n]=d.particles[n],u.push(d.particles[n])},dropNode:function(e){var n=e.id,t=d.particles[n],i=$.inArray(t,u);i>-1&&u.splice(i,1),delete d.particles[n],delete s.particles[n]},modifyNode:function(e,n){if(e in d.particles){var t=d.particles[e];"x"in n&&(t.p.x=n.x),"y"in n&&(t.p.y=n.y),"m"in n&&(t.m=n.m),"f"in n&&(t.fixed=1===n.f),"_m"in n&&(t._m===undefined&&(t._m=t.m),t.m=n._m)}},addSpring:function(e){var n=e.id,t=e.l,i=d.particles[e.fm],r=d.particles[e.to];i!==undefined&&r!==undefined&&(d.springs[n]=new Spring(i,r,t,y.stiffness),c.push(d.springs[n]),i.connections++,r.connections++,delete s.particles[e.fm],delete s.particles[e.to])},dropSpring:function(e){var n=e.id,t=d.springs[n];t.point1.connections--,t.point2.connections--;var i=$.inArray(t,c);i>-1&&c.splice(i,1),delete d.springs[n]},_update:function(e){return l++,$.each(e,function(e,n){n.t in y&&y[n.t](n)}),l},tick:function(){y.tendParticles(),"euler"==y.integrator?(y.updateForces(),y.updateVelocity(y.dt),y.updatePosition(y.dt)):(y.updateForces(),y.cacheForces(),y.updatePosition(y.dt),y.updateForces(),y.updateVelocity(y.dt)),y.tock()},tock:function(){var e=[];$.each(d.particles,function(n,t){e.push(n),e.push(t.p.x),e.push(t.p.y)}),r&&r({geometry:e,epoch:l,energy:p,bounds:f})},tendParticles:function(){$.each(d.particles,function(e,n){n._m!==undefined&&(Math.abs(n.m-n._m)<1?(n.m=n._m,delete n._m):n.m*=.98),n.v.x=n.v.y=0})},updateForces:function(){y.repulsion>0&&(y.theta>0?y.applyBarnesHutRepulsion():y.applyBruteForceRepulsion()),y.stiffness>0&&y.applySprings(),y.applyCenterDrift(),y.gravity&&y.applyCenterGravity()},cacheForces:function(){$.each(d.particles,function(e,n){n._F=n.f})},applyBruteForceRepulsion:function(){$.each(d.particles,function(e,n){$.each(d.particles,function(e,t){if(n!==t){var i=n.p.subtract(t.p),r=Math.max(1,i.magnitude()),o=(i.magnitude()>0?i:Point.random(1)).normalize();n.applyForce(o.multiply(y.repulsion*(t._m||t.m)*.5).divide(r*r*.5)),t.applyForce(o.multiply(y.repulsion*(n._m||n.m)*.5).divide(r*r*-.5))}})})},applyBarnesHutRepulsion:function(){if(f.topleft&&f.bottomright){var e=new Point(f.bottomright),n=new Point(f.topleft);a.init(n,e,y.theta),$.each(d.particles,function(e,n){a.insert(n)}),$.each(d.particles,function(e,n){a.applyForces(n,y.repulsion)})}},applySprings:function(){$.each(d.springs,function(e,n){var t=n.point2.p.subtract(n.point1.p),i=n.length-t.magnitude(),r=(t.magnitude()>0?t:Point.random(1)).normalize();n.point1.applyForce(r.multiply(n.k*i*-.5)),n.point2.applyForce(r.multiply(n.k*i*.5))})},applyCenterDrift:function(){var e=0,n=new Point(0,0);if($.each(d.particles,function(t,i){n.add(i.p),e++}),0!=e){var t=n.divide(-e);$.each(d.particles,function(e,n){n.applyForce(t)})}},applyCenterGravity:function(){$.each(d.particles,function(e,n){var t=n.p.multiply(-1);n.applyForce(t.multiply(y.repulsion/100))})},updateVelocity:function(e){var n=0,t=0,i=0;$.each(d.particles,function(r,o){if(o.fixed)return o.v=new Point(0,0),void(o.f=new Point(0,0));"euler"==y.integrator?o.v=o.v.add(o.f.multiply(e)).multiply(1-y.friction):o.v=o.v.add(o.f.add(o._F.divide(o._m)).multiply(.5*e)).multiply(1-y.friction),o.f.x=o.f.y=0;var a=o.v.magnitude();a>1e3&&(o.v=o.v.divide(a*a));var d=(a=o.v.magnitude())*a;n+=d,t=Math.max(d,t),i++}),p={sum:n,max:t,mean:n/i,n:i}},updatePosition:function(e){var n=null,t=null;$.each(d.particles,function(i,r){if("euler"==y.integrator)r.p=r.p.add(r.v.multiply(e));else{var o=r.f.multiply(.5*e*e).divide(r.m);r.p=r.p.add(r.v.multiply(e)).add(o)}if(!n)return n=new Point(r.p.x,r.p.y),void(t=new Point(r.p.x,r.p.y));var a=r.p;null!==a.x&&null!==a.y&&(a.x>n.x&&(n.x=a.x),a.y>n.y&&(n.y=a.y),a.x<t.x&&(t.x=a.x),a.y<t.y&&(t.y=a.y))}),f={topleft:t||new Point(-1,-1),bottomright:n||new Point(1,1)}},systemEnergy:function(e){return p}};return y.init()},_nearParticle=function(e,n){var n=n||0,t=e.x,i=e.y,r=2*n;return new Point(t-n+Math.random()*r,i-n+Math.random()*r)},trbl=null,_newBounds=null;if(void 0===window)return function(){$={each:function(e,n){if($.isArray(e))for(var t=0,i=e.length;t<i;t++)n(t,e[t]);else for(var r in e)n(r,e[r])},map:function(e,n){var t=[];return $.each(e,function(e,i){var r=n(i);r!==undefined&&t.push(r)}),t},extend:function(e,n){if("object"!=typeof n)return e;for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e},isArray:function(e){return!!e&&-1!=e.constructor.toString().indexOf("Array")},inArray:function(e,n){for(var t=0,i=n.length;t<i;t++)if(n[t]===e)return t;return-1},isEmptyObject:function(e){if("object"!=typeof e)return!1;var n=!0;return $.each(e,function(e,t){n=!1}),n}};var e=function(){var e=20,n=null,t=null,i=null,r=((new Date).valueOf(),{init:function(e){return r.timeout(e.timeout),n=Physics(e.dt,e.stiffness,e.repulsion,e.friction,r.tock),r},timeout:function(n){n!=e&&(e=n,null!==t&&(r.stop(),r.go()))},go:function(){null===t&&(i=null,t=setInterval(r.tick,e))},stop:function(){null!==t&&(clearInterval(t),t=null)},tick:function(){n.tick();var e=n.systemEnergy();(e.mean+e.max)/2<.05?(null===i&&(i=(new Date).valueOf()),(new Date).valueOf()-i>1e3&&r.stop()):i=null},tock:function(e){e.type="geometry",postMessage(e)},modifyNode:function(e,t){n.modifyNode(e,t),r.go()},modifyPhysics:function(e){n.modifyPhysics(e)},update:function(e){n._update(e)}});return r}();onmessage=function(n){if(n.data.type)if("physics"!=n.data.type)switch(n.data.type){case"modify":e.modifyNode(n.data.id,n.data.mods);break;case"changes":e.update(n.data.changes),e.go();break;case"start":e.go();break;case"stop":e.stop();break;case"sys":t=n.data.param||{};isNaN(t.timeout)||e.timeout(t.timeout),e.modifyPhysics(t),e.go()}else{var t=n.data.physics;e.init(n.data.physics)}else postMessage("¿kérnèl?")}}();window.arbor="undefined"!=typeof arbor?arbor:{},arbor=Object.assign({},{ParticleSystem:ParticleSystem,Point:function(e,n){return new Point(e,n)},etc:{trace:trace,dirname:dirname,basename:basename,ordinalize:ordinalize,objcopy:objcopy,objcmp:objcmp,objkeys:objkeys,objmerge:objmerge,uniq:uniq,arbor_path:arbor_path}})}(this.jQuery,window,document);